<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Resume Optimizer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/htmx.org@1.9.6"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">

    <div class="max-w-2xl mx-auto px-6 py-10">
        <h1 class="text-4xl font-bold text-center mb-10 text-gray-800">Resume Optimizer</h1>

        <form action="/process" method="POST" enctype="multipart/form-data"
            class="bg-white rounded-lg shadow-xl p-8 space-y-6">

            <!-- Resume Upload -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                    Resume (PDF)
                </label>
                <input type="file" name="resume" accept=".pdf"
                    class="w-full border border-gray-300 rounded px-3 py-2" />
            </div>

            <!-- Job Description -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                    Job Description <span class="text-red-500">*</span>
                </label>
                <textarea name="jobDescription" required rows="6" placeholder="Paste job description..."
                    class="w-full border border-gray-300 rounded px-3 py-2 resize-none"></textarea>
            </div>

<!-- GitHub Username + Fetch -->
    <div>
        <label class="block text-sm font-medium text-gray-700 mb-1">
            GitHub Username
        </label>
        <div class="flex space-x-3">
            <input type="text" name="githubUsername" id="githubUsername" placeholder="e.g., johndoe"
                   class="flex-1 border border-gray-300 rounded px-3 py-2" />
            <button type="button"
                    class="bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600 transition"
                    hx-post="/repos"
                    hx-include="#githubUsername"
                    hx-target="#github-repos"
                    hx-swap="innerHTML">
                Fetch
            </button>
        </div>

        <!-- ðŸ‘‡ This will receive the dynamic checkboxes -->
        <div id="github-repos" class="mt-2 text-sm text-gray-700 space-y-2">
            <!-- htmx injects selected checkboxes here -->
        </div>
    </div>

    <!-- Submit -->
    <button type="submit"
            class="w-full bg-blue-600 text-white py-3 px-6 rounded-lg hover:bg-blue-700 transition mt-4">
        Optimize Resume
    </button>

        </form>
    </div>

    <script>
        document.body.addEventListener('htmx:beforeRequest', function (evt) {
            const button = evt.detail.elt;
            if (button.tagName === "BUTTON") {
                button.disabled = true;
                button.innerText = "Loading...";
            }
        });

        document.body.addEventListener('htmx:afterSettle', function (evt) {
            const button = evt.detail.elt;
            if (button.tagName === "BUTTON") {
                button.disabled = false;
                button.innerText = "Fetch";
            }
        });
    </script>
</body>

</html>